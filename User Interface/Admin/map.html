<!DOCTYPE html>

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
        EVUser
    </title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.css" />
    <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"></script>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>EVDP Admin</title>

    <!-- Google Font: Source Sans Pro -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="plugins/fontawesome-free/css/all.min.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <!-- Tempusdominus Bootstrap 4 -->
    <link rel="stylesheet" href="plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css">
    <!-- iCheck -->
    <link rel="stylesheet" href="plugins/icheck-bootstrap/icheck-bootstrap.min.css">
    <!-- JQVMap -->
    <link rel="stylesheet" href="plugins/jqvmap/jqvmap.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="dist/css/adminlte.min.css">
    <!-- overlayScrollbars -->
    <link rel="stylesheet" href="plugins/overlayScrollbars/css/OverlayScrollbars.min.css">
    <!-- Daterange picker -->
    <link rel="stylesheet" href="plugins/daterangepicker/daterangepicker.css">
    <!-- summernote -->
    <link rel="stylesheet" href="plugins/summernote/summernote-bs4.min.css">



    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
    <!-- <link rel="stylesheet" type="text/css" href="styles.css"> -->

</head>

<body class="hold-transition sidebar-mini layout-fixed">
    <div class="wrapper">
        <!-- Navbar -->
        <nav class="main-header navbar navbar-expand navbar-white navbar-light">
            <!-- Left navbar links -->
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
                </li>
                <li class="nav-item d-none d-sm-inline-block">
                    <a href="index.html" class="nav-link">Home</a>
                </li>
                <li class="nav-item d-none d-sm-inline-block">
                    <a href="carGraph.html" class="nav-link">Car Graph</a>
                </li>
            </ul>

            <!-- Right navbar links -->
            <ul class="navbar-nav ml-auto">


            </ul>
        </nav>
        <!-- /.navbar -->

        <!-- Main Sidebar Container -->
        <aside class="main-sidebar sidebar-light-secondary elevation-4">
            <!-- Brand Logo -->
            <a href="index3.html" class="brand-link">
                <img src="dist/img/AdminLTELogo.png" alt="AdminLTE Logo" class="brand-image img-circle elevation-3" style="opacity: .8">
                <span class="brand-text font-weight-light">EVDP</span>
            </a>

            <!-- Sidebar -->
            <div class="sidebar">
                <!-- Sidebar user panel (optional) -->
                <div class="user-panel mt-3 pb-3 mb-3 d-flex">

                    <div class="info">
                        <a href="#" class="d-block">EVDP Admin</a>
                    </div>
                </div>

                <!-- SidebarSearch Form -->


                <!-- Sidebar Menu -->
                <nav class="mt-2">
                    <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
                        <!-- Add icons to the links using the .nav-icon class
               with font-awesome or any other icon font library -->
                        <li class="nav-item menu-open">
                            <a href="index.html" class="nav-link active">
                                <i class="nav-icon fas fa-tachometer-alt"></i>
                                <p>
                                    Dashboard
                                    <i class="right fas fa-angle-left"></i>
                                </p>
                            </a>

                        </li>
                        <li class="nav-item">
                            <a href="" class="nav-link">
                                <i class="nav-icon fas fa-play"></i>
                                <p>
                                    Simulation
                                    <span class="right badge badge-danger">New</span>
                                </p>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="" class="nav-link">
                                <i class="nav-icon fas fa-robot"></i>
                                <p>
                                    ML Model
                                    <span class="right badge badge-warning">RFR</span>
                                </p>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="pricebargraph.html" class="nav-link">
                                <i class="nav-icon fas fa-money-bill"></i>
                                <p>
                                    Price Chart
                                    <span class="right badge badge-primary">&#8377;</span>
                                </p>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="carstatus.html" class="nav-link">
                                <i class="nav-icon fas fa-car"></i>
                                <p>
                                    Car Status
                                </p>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="stnstatus.html" class="nav-link">
                                <i class="nav-icon fas fa-charging-station"></i>
                                <p>
                                    Station Status
                                </p>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="map.html" class="nav-link">
                                <i class="nav-icon fas fa-map"></i>
                                <p>
                                    Map
                                    <span class="right badge badge-secondary">Go</span>

                                </p>
                            </a>
                        </li>
                    </ul>
                </nav>
                <!-- /.sidebar-menu -->
            </div>
            <!-- /.sidebar -->
        </aside>

        <!-- connect mongodb and fetch price -->


    </div>


    <style>
        #map {
            position: absolute;
            left: 19%;
            width: 80%;
            top: 80px;
            bottom: 2.5%;
        }
        
        h6 {
            font-size: 18px;
            margin: 0;
            font-weight: 400;
        }
        
        h5 {
            font-size: 22px;
            margin: 0;
            font-weight: 400;
            padding: 10px 2px;
        }
    </style>
    <div id="map"></div>
    <script>
        var map = L.map('map').setView([22.555, 88.371], 13);
        L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
            attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
            maxZoom: 12,
            id: 'mapbox/streets-v11',
            tileSize: 512,
            zoomOffset: -1,
            accessToken: 'pk.eyJ1IjoiZGVib3ByaXlvZGoiLCJhIjoiY2wyMWs4NGg0MTY0NzNibXRjbTVtazkzbSJ9.AZFISzXydyjlqVpY5IMlqQ'
        }).addTo(map);
        //https://www.mapbox.com/
        var LeafIcon = L.Icon.extend({
            options: {
                //shadowUrl: 'iconb.png',
                iconSize: [50, 54],
                shadowSize: [50, 64],
                iconAnchor: [22, 94],
                shadowAnchor: [4, 62],
                popupAnchor: [-3, -76]
            }
        });

        var greenIcon = new LeafIcon({
                iconUrl: 'green.jpg'
            }),
            redIcon = new LeafIcon({
                iconUrl: 'red.jpg'
            }),
            blackIcon = new LeafIcon({
                iconUrl: 'black.png'
            });

        //static station data
        var res;

        function change() {

            $.ajax({
                async: false,
                type: "POST",
                url: "fetchdata.php",
                success: function(response) {
                    res = JSON.parse(response);
                    console.log(res);
                }
            });

            //static station data

            var data = [{
                "code": "Mahindra Charging Station",
                "lat": "22.5783965",
                "lng": "88.4523585",
                "location": "1",
                "icon": res[0].icon,
                "price": res[0].price,
                "Available_ports": res[0].no_of_port_available
            }, {
                "code": "Hero Electric Charging Station",
                "lat": "22.5485285",
                "lng": "88.2904633",
                "location": "2",
                "icon": res[1].icon,
                "price": res[1].price,
                "Available_ports": res[1].no_of_port_available
            }, {
                "code": "Electric Vehicle Charging Station",
                "lat": "22.5615108",
                "lng": "88.3665607",
                "location": "3",
                "icon": res[2].icon,
                "price": res[2].price,
                "Available_ports": res[2].no_of_port_available
            }, {
                "code": "Electric Vehicle Charging Station",
                "lat": "22.5389976",
                "lng": "88.3288476",
                "location": "4",
                "icon": res[3].icon,
                "price": res[3].price,
                "Available_ports": res[3].no_of_port_available
            }, {
                "code": "Electric Vehicle Charging Station",
                "lat": "22.5298197",
                "lng": "88.2942399",
                "location": "5",
                "icon": String(res[4].icon),
                "price": res[4].price,
                "Available_ports": res[4].no_of_port_available
            }, {
                "code": "EESL Charging Station",
                "lat": "22.5788384",
                "lng": "88.4629932",
                "location": "6",
                "icon": res[5].icon,
                "price": res[5].price,
                "Available_ports": res[5].no_of_port_available
            }, {
                "code": "Hero Electric Charging Station",
                "lat": "22.5110668",
                "lng": "88.3465815",
                "location": "7",
                "icon": res[6].icon,
                "price": res[6].price,
                "Available_ports": res[6].no_of_port_available
            }, {
                "code": " Electric Vehicle Charging Station",
                "lat": "22.5126164",
                "lng": "88.3300567",
                "location": "8",
                "icon": res[7].icon,
                "price": res[7].price,
                "Available_ports": res[7].no_of_port_available
            }, {
                "code": "Electric Vehicle Charging Point",
                "lat": "22.5656085",
                "lng": "88.3923503",
                "location": "9",
                "icon": res[8].icon,
                "price": res[8].price,
                "Available_ports": res[8].no_of_port_available


            }, {
                "code": "Electric Vehicle Charging Station",
                "lat": "22.581631",
                "lng": "88.4261743",
                "location": "10",
                "icon": res[9].icon,
                "price": res[9].price,
                "Available_ports": res[9].no_of_port_available
            }];
            console.log(data);
            // for (var i = 0; i < data.length; i++) {
            //     var datum = input[i];
            //     if (!d[datum.key]) {
            //         d[datum.key] = [];
            //     }
            //     d[datum.key].push(datum.val);
            // }
            //add marker on map
            for (var i = 0; i < data.length; i++) {
                const popupContent =
                    '<h6>' + data[i].code + '</h6>' +
                    '<h5><strong>' + 'Price Now : ' + data[i].price + '/-' + '</strong>' + '</h5>' +
                    '<h6> Available ports:' + data[i].Available_ports + '</h6>';
                // add the marker and popup to the map.

                L.marker([data[i].lat, data[i].lng], {
                    icon: eval(data[i].icon)
                }).addTo(map).bindPopup(popupContent);

            }
        }
        var a;
        a = setInterval(change, 300); //lane highlight
        var osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);


        L.Control.geocoder().addTo(map);
    </script>






    <!-- jQuery -->
    <script src="plugins/jquery/jquery.min.js"></script>
    <!-- jQuery UI 1.11.4 -->
    <script src="plugins/jquery-ui/jquery-ui.min.js"></script>
    <!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
    <script>
        $.widget.bridge('uibutton', $.ui.button)
    </script>
    <!-- Bootstrap 4 -->
    <script src="plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- ChartJS -->
    <script src="plugins/chart.js/Chart.min.js"></script>
    <!-- Sparkline -->
    <script src="plugins/sparklines/sparkline.js"></script>
    <!-- JQVMap -->
    <script src="plugins/jqvmap/jquery.vmap.min.js"></script>
    <script src="plugins/jqvmap/maps/jquery.vmap.usa.js"></script>
    <!-- jQuery Knob Chart -->
    <script src="plugins/jquery-knob/jquery.knob.min.js"></script>
    <!-- daterangepicker -->
    <script src="plugins/moment/moment.min.js"></script>
    <script src="plugins/daterangepicker/daterangepicker.js"></script>
    <!-- Tempusdominus Bootstrap 4 -->
    <script src="plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js"></script>
    <!-- Summernote -->
    <script src="plugins/summernote/summernote-bs4.min.js"></script>
    <!-- overlayScrollbars -->
    <script src="plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js"></script>
    <!-- AdminLTE App -->
    <script src="dist/js/adminlte.js"></script>

    <script src="dist/js/pages/dashboard.js"></script>

</body>

</html>